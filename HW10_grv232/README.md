I got help from Baiyue Cao on the fourier transformation part. :)
